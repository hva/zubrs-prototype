{% extends '_base.html' %}

{% block content %}

<div class="small-12 columns">
    <div class="row">
        <div class="small-4 columns">
            <ul data-orbit>
                {% for id, x in news_main %}
                <li data-bz-orbit-source="news-{{ id }}">
                    <img src="{{ x.img }}" />
                    <a href="news.php?id={{ id }}"><div class="orbit-caption">{{ x.title }}</div></a>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="small-4 columns">
            <h5><a href="news.php">Новости</a></h5>
            <ul class="side-nav">
                {% for id, x in news_main %}
                <li data-bz-orbit-target="news-{{ id }}">
                    <a href="news.php?id={{ id }}">{{ x.title }}</a>
                </li>
                {% if not loop.last %}
                <li class="divider"></li>
                {% endif %}
                {% endfor %}
            </ul>
        </div>

        <div class="small-4 columns">
            <h5><a href="video.php">Видео</a></h5>
            <div class="flex-video">
                <iframe width="640" height="360" src="{{ load('video')|first.src }}" frameborder="0" allowfullscreen></iframe>
            </div>
        </div>
    </div>
    <div class="row">
        <div class="small-4 columns">
            <ul data-orbit>
                {% for id, x in news_child %}
                <li data-bz-orbit-source="news-{{ id }}">
                    <img src="{{ x.img }}" />
                    <a href="news.php?id={{ id }}"><div class="orbit-caption">{{ x.title }}</div></a>
                </li>
                {% endfor %}
            </ul>
        </div>

        <div class="small-4 columns">
            <h5><a href="news.php">Детский спорт</a></h5>
            <ul class="side-nav">
                {% for id, x in news_child %}
                <li data-bz-orbit-target="news-{{ id }}">
                    <a href="news.php?id={{ id }}">{{ x.title }}</a>
                </li>
                {% if not loop.last %}
                <li class="divider"></li>
                {% endif %}
                {% endfor %}
            </ul>
        </div>

        {% set competitions = load('competitions') %}
        {% set games = load('games') %}
        {% set teams = load('teams') %}

        <div class="small-4 columns end">
            <h5><a href="competitions.php">Результаты</a></h5>
            <ul data-orbit data-options="bullets:false;timer:false">
                {% for x in games if (not teams[x.team_home].hidden or not teams[x.team_away].hidden) %}
                <li>
                    <div class="panel">
                        <div class="row">
                            <div class="small-6 columns">
                                <h6><a href="/competitions.php?id={{ x.competition_id }}">{{ competitions[x.competition_id].title }}</a></h6>
                            </div>
                            <div class="small-6 columns text-right">
                                <span style="font-size: 0.8rem">{{ x.date|date('j.m.Y H:i') }}</span>
                            </div>
                        </div>
                        <div class="row">
                            <div class="small-8 columns">
                                {{ teams[x.team_home].title }}
                            </div>
                            <div class="small-4 columns text-right">
                                {{ x.score_home }}
                            </div>
                        </div>
                        <div class="row">
                            <div class="small-8 columns">
                                {{ teams[x.team_away].title }}
                            </div>
                            <div class="small-4 columns text-right">
                                {{ x.score_away }}
                            </div>
                        </div>
                    </div>
                </li>
                {% endfor %}
            </ul>
        </div>

     </div>
</div>

{% endblock %}

{% block scripts %}
<script>
    var delay=400,
        setTimeoutConst,
        gotoLink = function(link) {
            if ((typeof link === 'string') && (link = $.trim(link)) != "") {
                var slide = $(document).find('[data-bz-orbit-source=' + link + ']');
                if (slide.index() != -1) {
                    var orbit = slide.closest('[data-orbit]').data('Instance');
                    orbit._goto(slide.index());
                }
            }
        };
    $('[data-bz-orbit-target]').hover(
        function() {
            var link = $(this).attr('data-bz-orbit-target');
            setTimeoutConst = setTimeout(gotoLink, delay, link);
        },
        function() {
            clearTimeout(setTimeoutConst);
        }
    );
</script>
{% endblock %}
